#include <LoRa.h>

const int ventRelay = 5;
const int dcRelay = 6;
const int resetRelay = 7;

void setup() {
  Serial.begin(9600);
  LoRa.begin(915E6);
  pinMode(ventRelay,OUTPUT);
  pinMode(dcRelay,OUTPUT);
  digitalWrite(ventRelay,LOW);
  digitalWrite(dcRelay,LOW);
}

void vent() {
  digitalWrite(ventRelay,HIGH);
}

void DC() {
  digitalWrite(dcRelay,HIGH);
}

void RESET() {
  digitalWrite(resetRelay,HIGH);
}

void CLOSE() {
  digitalWrite(dcRelay,LOW);
  digitalWrite(resetRelay,LOW);
  digitalWrite(ventRelay,LOW);
}

void loop() {
  String rfInput;
  int packetSize = LoRa.parsePacket();
  if (packetSize) {
    while (LoRa.available()) {
      rfInput = LoRa.read();
      Serial.println(rfInput);
    }
  }
  if(rfInput = "VENT"){
    vent();
    Serial.println("VENTING");
  }else if(rfInput = "DISCONNECT"){
    Serial.println("DISCONNECTING FUELING LINE");
    DC();
    Serial.println("FUELLING LINE DISCONNECTED");
  }else if(rfInput = "RESET"){
    RESET();
    Serial.println("RESETTING FUELING LINE");
  }else if(rfInput = "CLOSE"){
    CLOSE();
    Serial.println("AWAITING COMMAND");
  }
}
